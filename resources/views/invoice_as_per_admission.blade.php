@extends('layouts.app') @section('content')@section('link_css')<link rel="stylesheet" href="{{asset('css/jquery-confirm.min.css')}}">@endsection<div id="wrapper">    <div class="wrapper wrapper-content">	        <div class="row onetop">				            <div class="col-lg-4">                <div class="ibox float-e-margins">                    <div class="ibox-title">					@if($lesssonRecord->isNotEmpty())                        <span class="label label-default pull-right"><a href="{{url('invoice').'/'.$lesssonRecord_student->admissionId}}">View All</a></span>					@endif                        <h5>Entries during past 6 months</h5>                    </div>                    <div class="ibox-content">                        <h1 class="no-margins">{{$lesssonRecord_count}}</h1>                        <small>Total Entries</small>                    </div>                </div>            </div>            <div class="col-lg-4">                <div class="ibox float-e-margins">                    <div class="ibox-title">					@if($lesssonRecord->isNotEmpty())                        <span class="label label-default pull-right"><a href=" {{url('invoice/').'/'.$lesssonRecord_student->admissionId}}?which=2">View All</a></span>					@endif                        <h5>Approved Entries</h5>                    </div>                    <div class="ibox-content">                        <h1 class="no-margins">{{$lesssonRecord_approved}}</h1>                        <small>Total Entries</small>                    </div>                </div>            </div>            <div class="col-lg-4">                <div class="ibox float-e-margins">                    <div class="ibox-title">					@if($lesssonRecord->isNotEmpty())                        <span class="label label-default pull-right"><a href=" {{url('invoice/').'/'.$lesssonRecord_student->admissionId}}?which=1">View All</a></span>						@endif                        <h5>Awaiting Entries</h5>                    </div>                    <div class="ibox-content">                        <h1 class="no-margins">{{($lesssonRecord_count-$lesssonRecord_approved)}}</h1>                        <small>Total Entries</small>                    </div>                </div>            </div>			</div>        @if($lesssonRecord->isNotEmpty())        <div class="row">            <div class="col-lg-12">                <div class="table-responsive">                    <table class="table table-striped">                        <thead>                        </thead>                        <tbody class="personal">                           <tr>                                <td><strong>Student Name</strong></td>                                <td><a href="{{url('viewStudent/')}}/{{$lesssonRecord_student->hasStudentName->studentId}}" data-toggle="tooltip" data-placement="bottom" title="View profile for student "> {{$lesssonRecord_student->hasStudentName->firstName}} {{$lesssonRecord_student->hasStudentName->lastName}}</a></td>                            </tr>                            <tr>                               <td><strong>Instrument</strong></td>                                <td>{{$lesssonRecord_student->hasInsturmentName->instrumentName}}</td>                            </tr>                            <tr>                                <td><strong>Teacher Rate</strong></td>                                <td>{{$lesssonRecord_student->hasrate->teacherRate}}</td>                            </tr> 									                         														 <!--							 <tr>                                <td><strong>Teacher Rate</strong></td>                                <td>{{$lesssonRecord_student->hasrate->teacherRate}}</td>                            </tr> -->							                            <!--<tr>                                <td><strong>Type</strong></td>                                <td>                                    @php									$is_adj = $lesssonRecord_student->hasInsturmentName->instrumentName=='Adjustment'?1:0;									$delon = $is_adj?0:1;										switch ($lesssonRecord_student->sameDayCancel)										{										case "Y":											echo "St. Same Day Cancel"; 											break;										case "y":											echo "St. Same Day Makeup Cancel";											break;										case "A":											echo "Te. Cancel"; $delon = 0;											break; 										case "a":											echo "St. Advance Cancel"; $delon = 0;												break;										case "V":											echo "Vacation";												break;										case "R": 											echo "Te. Makeup Lesson Cancel"; $delon = 0; 											break;										case "r":											echo "St. Makeup Advance Cancel"; $delon = 0; 											break;										case "M": 											echo "Makeup"; 												break; 										case "n": 											echo "Introductory";												break; 										case "O": 											echo "Other"; 												break; 										case "1": 										case "2":										case "3":										case "4":										echo "Regular + ";										$xt = $lesssonRecord_student->sameDayCancel*15;											echo "$xt makeup <br />(".($lesssonRecord_student->lessonDuration-$xt)." min base)"; break;										default:										if ($lesssonRecord_student->hasInsturmentName->instrumentName=='Adjustment')										echo "Adjustment";										else {											echo "Regular";											} 										 break; 										 }								 @endphp                                </td>                            </tr>-->                        </tbody>                    </table>                </div>            </div>        </div>				        <div class="row ">            <div class="col-sm-12">					<ul class="strip">			<li><span class="grayBlock">&nbsp;&nbsp;&nbsp;&nbsp;</span>  Entry has been approved and cannot be edited or deleted anymore.</li>																					<li><span class="whiteBlock">&nbsp;&nbsp;&nbsp;&nbsp;</span>  (Alternating) Entry is awaiting approval and can be modified by you.</li>		</ul>						                <p><i class="fa fa-hand-o-right"></i> All checks and approvals are issued on a monthly schedule. All entries (ordered by most recent entry date first)</p>            </div>        </div>		@if(count($lesssonRecord) >0)		<div class="row ">            <div class="col-sm-12">			<?php // print_r($user->teacherId); ?>			All entries by {{$user->teacherId->firstName}} {{$user->teacherId->lastName}} (ordered by most recent entry date first)<br>			</div>        </div>			<div class="row ">            <div class="col-sm-12">			<br>			<?php					$now = time();					$alterId = 123;					$months = Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");						$m = intval(date('m',$now)); $y = intval(date('Y',$now)); $i = 6;					while (--$i>-1) {						if ($i<5) echo "\n";						//if ($mon==$m&&$yr==$y) echo $months[$m-1]." $y";						//else 						echo				"		<span class='label label-default pull-left' style='margin-right:20px'><a href='/invoice/{$lesssonRecord[0]->admissionId}/{$m}/{$y}'>".							$months[$m-1]." {$y}</a></span> &nbsp;&nbsp;&nbsp;&nbsp;";						--$m;						if ($m==0) {$m += 12; --$y;}					}				?>			</div>        </div>			@endif	@endif		@if($lesssonRecord->isNotEmpty())         <div class="row paddingzero">            <div class="col-sm-12">                <div class="ibox float-e-margins">                    <div class="ibox-content">                        <div class="table-responsive">                            <table class="table table-striped">                               <thead>                                  <tr>                                    <th class="one">Date</th>                                    <th class="two">Type</th>                                    <th class="three">Instr.</th>                                     <th class="four">Time</th>                                     <th class="five">Rate/Hr</th>                                     <th class="six">Pay</th>                                      <th class="seven">&nbsp;</th>                                    </tr>                                </thead>                                <tbody class="personal">                                    <?php $i=1; $amt=0;?> @foreach($lesssonRecord as $lesson)									@php $amt += $lesson->amount; @endphp                                    @if($lesson->approveDate !='0000-00-00')								  <tr style="background-color:#CCCCCC">							  @else								  <tr style="background-color:#ffffff">							  @endif                                       <td class="one">{{date('m-d-y',strtotime($lesson->lessonDate))}}</td>                                        <td class="two">										@php											$is_adj = $lesson->hasInsturmentName->instrumentName=='Adjustment'?1:0;											$delon = $is_adj?0:1;											switch ($lesson->sameDayCancel)											{											case "Y":												echo "St. Same Day Cancel"; 												break;											case "y":												echo "St. Same Day Makeup Cancel";												break;											case "A":												echo "Te. Cancel"; $delon = 0;												break; 											case "a":												echo "St. Advance Cancel"; $delon = 0;													break;											case "V":												echo "Vacation";													break;											case "R": 												echo "Te. Makeup Lesson Cancel"; $delon = 0; 												break;											case "r":												echo "St. Makeup Advance Cancel"; $delon = 0; 												break;											case "M": 												echo "Makeup"; 													break; 											case "n": 												echo "Introductory";													break; 											case "O": 												echo "Other"; 													break; 											case "1": 											case "2":											case "3":											case "4":											echo "Regular+";											$xt = $lesson->sameDayCancel*15;												echo "$xt makeup <br>(".($lesson->lessonDuration-$xt)."min base)"; break;											default:											if ($lesson->hasInsturmentName->instrumentName=='Adjustment')											echo "Adjustment";											else {												echo "Regular";												} 											 break; 											 }								 @endphp                                        </td>                                        <td class="three">{{$lesson->hasInsturmentName->instrumentName}}</td>                                        <td class="four">{{$lesson->lessonDuration}}</td>                                       <td class="five">{{$lesson->hasrate->teacherRate}}</td>                                        <td class="six">{{$lesson->amount}}</td>                                        <td class="seven">                                            @if($lesson->approveDate !='0000-00-00')										---										@else										<a href="javascript:confirmDelete('{{$lesson->lessonId}}');" ><i class="fa fa-trash white fa-lg"></i> <span class="nav-label"></span></a></a>										</td>											@endif								</tr>                             @endforeach								<tr >								<td class="two"></td>								<td class="seven1"></td>								<td class="four1"></td>								<td class="five1"></td>								<td  align="right"><strong>Total Earnings: </strong></td>								<td ><strong>{{$amt}}</strong></td>								<td class="" style="border-top:0px;" ></td>								</tr>                              </tbody>                          </table>                       </div>                    </div>                </div>            </div>       </div>	   		<div class="row">			<div class="col-sm-12">				<div class="alert alert-info">					<p><strong>NOTE:</strong> Amount does not reflect guaranteed earnings. It is based on your submissions and is subject to approval by Musika</p>				</div>            </div>        </div>		@else		<div class="row">			<div class="col-sm-12">				<div class="alert alert-info">					<p>No Entry found for this student, please submit new entry <a href"#"> <strong>Submit New Entry &nbsp;&nbsp; </strong>or </a> <a href="{{ url()->previous() }}" class=""><strong> &nbsp;&nbsp; Go back</strong></a></p>				</div>			</div>        </div>		@endif    </div></div>@endsection@section('custom_js')<script>function confirmDelete(lessonId){	$.confirm({					title: 'Confirm!',					content: "Do you want to delete this lesson?",					    buttons: {						confirm: function () {							var csrf_token = $("input[name=_token]").val();					$.ajax({						url: "<?php echo url('/invoice/deletelesson') ?>",						data: {							lessonId:lessonId,							_token: csrf_token						},						type: 'POST',						dataType: 'json',						success: function(response){							if(response.status=='true')							{								$.alert({ title: 'Alert!', content: 'Lesson deleted successfully!',});								location.reload();							} else {								$.alert({ title: 'Alert!', content:'Apparently, lessonId '+lessonId+' either doesn\'t exist or has already been approved. Please try again',});							}													},						error: function(e){																				}					});													},						cancel: function () {													},											}									});		}	</script>@endsection@section('scripts')<script src="{{asset('js/jquery-confirm.min.js')}}"></script>@endsection