@extends('layouts.app')@section('custom_css')<link rel="stylesheet" href="{{asset('css/jquery-confirm.min.css')}}"><link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css"><style>ul label{	font-weight: 500 !important;}.todo-list {    font-size: 13px !important;}.title-action a{	 text-decoration: underline; }</style>@endsection@section('content')  <div class="row wrapper border-bottom white-bg page-heading">                <div class="col-sm-10">                    <h2 style="font-size: 21px; !important"  class="getstatus-heading">Inform Musika of any changes in this student's situation using this form. </h2>                </div>                <div class="col-sm-2">                    <div class="title-action">                        <a href="{{url('/')}}">Back to students</a>                    </div>                </div>            </div>	<div class="wrapper wrapper-content">	<div class="row paddingzero"><div class="col-lg-10">@if (session('status'))                    <div class="alert alert-success">                        {{ session('status') }}                    </div>			@endif </div>			</div>			<div class="row  paddingzero">		<!--	<form action="{{url('/updateStatus')}}" method='post' onsubmit="return chkForm(this)"> -->		<form action="{{url('/updateStatus')}}" method='post' id='frm'> <!-- onsubmit="return chkForm2(this)"> -->	 {{csrf_field()}}      <div class="col-lg-12" style="padding-right: 0px !important; padding-left: 0px !important;">                <div class="ibox-content" style="padding: 10px 2px 0px 2px; !important">                    <ul class="todo-list m-t">				<li>				  <div class="table-responsive">                <table class="table table-striped">							<thead>							<tr>							<th>Name</th>							<th>Instr.</th>							<th>Last Status</th>							</tr>							</thead>								<tbody class="personal">								<tr>								<td class="status"><strong>{{$prospective_students->prospectiveStudent->firstName.' '.$prospective_students->prospectiveStudent->lastName}}</strong></td>								<td><strong>{{$prospective_students->instrument->instrumentName}}</strong></td>								@if(isset($prospective_students->pro_status))		<td class="status"><strong>{{str_replace("Teacher","I",$prospective_students->pro_status->statusDesc)}}</strong></td>@else		<td class="status">			<div class="text-left"><span style="color:red">Unknown</div>		</td>		@endif								</tr>								</tbody>						</table>		            </div>				</li>				<div class="hr-line-dashed"></div> 				 <li>                           <label><input type='radio' name='stat' id='statintro' value='999' onclick="do_showhide('introinfo',this.checked)"/> 						 I have taught this student an introductory lesson</label>						 <ul class="todo-list m-t col-md-10" id="introinfo" style="padding-bottom:20px">							<li> <p>So we can better proceed with the next phase of the registration process for this student, please select which best describes this student's demeanor.</p><input type='hidden' name='introplus' value='' /></li>							 <li style="margin-bottom: 2px;">							<input type='radio' name='introplus' value='interested scheduled' /> Student/parent seemed interested in continuing and the next lesson date is scheduled</li>							<li style="margin-bottom: 2px;"><input type='radio' name='introplus' value='interested not scheduled' /> Student/parent seemed interested in continuing, but no next lesson date was scheduled</li>							<li style="margin-bottom: 2px;"><input type='radio' name='introplus' value='not interested' /> Student/parent are not interested in continuing; that is what they told me directly</li>							<li><input type='radio' name='introplus' value='unsure'/> Student/parent seemed unsure about continuing							 </li>							<li> </li>						 </ul>				</li>				@php $pd['name']=$prospective_students->prospectiveStudent->firstName.' '.$prospective_students->prospectiveStudent->lastName;				@endphp					@foreach($status as $state)						@if($state->statusId==4)						<li>						<label> 							<input value="{{$state->statusId}}" {{($state->statusId==$sid)?'checked':''}}   onclick="do_showhide('introinfo',document.getElementById('statintro').checked);"  name="stat" aria-label="Single radio One" type="radio">						   I spoke to student/parent and set up a first lesson date						</label><br/>						<span style=" padding-left: 20px;" id="date1"><b>DATE OF FIRST LESSON: </b><input type="text" name="intro_sh_date" id="datepicker" value="<?php if($prospective_students->intro_sh_date!=NULL) { echo date('m-d-Y',strtotime($prospective_students->intro_sh_date)); }?>" autocomplete="off" readonly="readonly" style=" width: 90px;" > <input type="hidden" name="dfgsd" id="crrdate" ><br/><span style="color:red;padding-left: 150px;" class="errordate"></span></span>						<input type="hidden" name="sh_date" id="sh_date" value="{{$prospective_students->intro_sh_date}}">						</li>						@elseif( $state->statusId==5 || $state->statusId==12 || $state->statusId==13)						@elseif($state->statusId==14)						<li>						<label> 							<input value="{{$state->statusId}}" {{($state->statusId==$sid)?'checked':''}}   onclick="do_showhide('introinfo',document.getElementById('statintro').checked);"  name="stat" aria-label="Single radio One" type="radio">						   Student has requested another Musika teacher.						</label>						   						 @if($state->statusName=='DTO')							 @php $dtoId = $state->statusId @endphp							   <ul class="todo-list m-t">						<li><label>Enter the reason in the box:<textarea class="form-control" name="reason{{$state->statusId}}"  cols="80"></textarea></label></li>								</ul>						   @endif						</li>						@else						<li>						<label> 							<input value="{{$state->statusId}}" {{($state->statusId==$sid)?'checked':''}}   onclick="do_showhide('introinfo',document.getElementById('statintro').checked);"  name="stat" aria-label="Single radio One" type="radio">						   {{str_replace("Teacher","I",$state->statusDesc)}}						</label>						</li>						@endif					@endforeach	                    </ul>					<div class="hr-line-dashed"></div> 					<div class="text-left">					<input  class="btn btn-primary" type="button" value="submit" onClick="chkForm2(frm)">					<div class="hr-line-dashed"></div> 					<p>					<strong>CONTRACT REMINDER:</strong> Making side arrangements to teach this lead or any other(s) outside the Musika program for the purpose of circumventing the Musika payment system, during your contract and for 2 years after you stop teaching with Musika, will result in a $5,000 penalty/acquisition fee per student. </p>                </div>				<input type='hidden' name='cid' value="{{$prospective_students->connectId}}">				<input type='hidden' name='sent' value='1'>            </div>		</div>     </form>  </div>@endsection@section('custom_js')<script src="{{asset('js/jquery-confirm.min.js')}}"></script><script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script><script>  $( function() {    $( "#datepicker" ).datepicker({ minDate: 0, dateFormat: 'mm-dd-yy' });    $('#crrdate').datepicker().datepicker('setDate',new Date());  } );  </script><script>function trim(str) { return trimR(trimL(str)); }function trimL(str) {	var i = -1; while (++i<str.length) { if (str.charCodeAt(i)>32) break; }	return str.substr(i);}function trimR(str) {	var i = str.length; while (--i>=0) { if (str.charCodeAt(i)>32) break; }	return str.substring(0,i+1);}function chkForm2(f){		var msg = 'This will send a reminder about the trial lesson day to the student. Are you sure this day is correct?';		var stat = $('input[name=stat]:checked').val();	var intro_sh_date = $('#datepicker').val();	var crrdate = $('#crrdate').val();	//console.log(intro_sh_date);		var res = intro_sh_date.split('-');	var validdate = res[2]+'-'+res[0]+'-'+res[1];	$("#sh_date").val(validdate);	//console.log(validdate);	var cdate = crrdate.split('/');	var currentDate = cdate[2]+'-'+cdate[0]+'-'+cdate[1];	//console.log(currentDate);	var dtMonth = res[0];		var dtDay= res[1];		var dtYear = res[2];        	//console.log(dtDay+' '+dtMonth+' '+dtYear);	var date=new Date();	var jscurrentDate=date.getFullYear()+"-"+(date.getMonth()+1)+"-"+date.getDate();	//var jscurrentDate=date.getFullYear()+"-"+(date.getMonth()+1)+"-"+date.getDate()+" "+date.getHours()+":"+date.getMinutes()+":"+date.getSeconds();	//var currentDate = '<?php echo date('Y-m-d H:i:s'); ?>';	//console.log(currentDate);	//console.log(Date.parse(validdate));	//console.log(Date.parse(currentDate));	//date = new Date();	//var d = new Date(date.getTime() - (date.getTimezoneOffset() * 60000)).toJSON();	//console.log(d);	if(stat==4){		if(intro_sh_date==''){			$('.errordate').html('Please select date of first lesson');			return false;		}		else if (Date.parse(validdate) < Date.parse(currentDate)){			$('.errordate').html('Date cannot be less then from current Date');			return false;		}		else if(!intro_sh_date.match(/^\d{2}-\d{2}-\d{4}$/)){			$('.errordate').html('Please enter date in valid format (Ex. MM-DD-YYYY).');			return false;		}		if (dtMonth < 1 || dtMonth > 12){			$('.errordate').html('Month should be correct for valid date.');			return false;		} 		else if (dtDay < 1 || dtDay> 31){			$('.errordate').html('Day should be correct for valid date.');			return false;		} 		else if ((dtMonth==4 || dtMonth==6 || dtMonth==9 || dtMonth==11) && dtDay ==31) {			$('.errordate').html('Day should be correct for valid date of this month.');			return false;		}		else if (dtMonth == 2) 		{			var isleap = (dtYear % 4 == 0 && (dtYear % 100 != 0 || dtYear % 400 == 0));			if (dtDay> 29 || (dtDay ==29 && !isleap)){				$('.errordate').html('Day should be correct for valid date of this month.');				return false;			}			else{				$('.errordate').html('');			}			}		else{			$('.errordate').html('');		}	}		if(stat==4){		if(confirm(msg)){		}		else{			return false;		}	}	//alert('asf');	//return false;	var res = chkForm(f);	if( res > 0){		/* $.confirm({					title: 'Confirm!',					content: "You have chosen to notify Musika about teaching {{$pd['name']}} an introductory lesson. Is this accurate?",					    buttons: {						confirm: function () { */							f.submit();						/* },						cancel: function () {						},					}				}); */	} else if(res==0) {		$.alert({ title: 'Alert!', content: "You must select a status before continuing.",});	}	}function chkForm(f) {	var i = -1; 	var checked = 0;	while (++i<f.stat.length) if (f.stat[i].checked) {		checked++;		if (f.stat[i].value==999) {			var is_reasoned = 0;			var j = -1; while (++j<f.introplus.length) {				if (f.introplus[j].checked) {is_reasoned = 1; break;}			}			if (is_reasoned){			/**	return confirm("You have chosen to notify Musika about teaching {{$pd['name']}} an introductory lesson. Is this accurate?"); **/				/**$.confirm({					title: 'Confirm!',					content: "You have chosen to notify Musika about teaching {{$pd['name']}} an introductory lesson. Is this accurate?",				});**/				//return false;			}				else {				/**alert("You have chosen to notify Musika about teaching {{$pd['name']}} an introductory lesson. So we can better proceed with the next phase of the registration process for this student, please select which best describes this student's demeanor.");**/				$.alert({ title: 'Alert!', content: "You have chosen to notify Musika about teaching {{$pd['name']}} an introductory lesson. So we can better proceed with the next phase of the registration process for this student, please select which best describes this student's demeanor.",});				//return false;				checked = -1;				break;			}		}		else if (f.stat[i].value=={{$dtoId}}) {	if (trim(f['reason{{$dtoId}}'].value)=='')				{					/**alert("You must input a reason before continuing."); **/					$.alert({ title: 'Alert!', content: "You must input a reason before continuing.",});				//	return false;				checked = -1;				break;				}		} 	}	/** alert("You must select a status before continuing."); **/	return checked;} function do_showhide(id, b) {	var el = document.getElementById(id);	el.style.display = b?'':'none';	var stat = $('input[name=stat]:checked').val();	if(stat==4){		$("#date1").css('display','block');	}	else{		$("#date1").css('display','none');	}}$(document).ready(function(){ do_showhide('introinfo',document.getElementById('statintro').checked); return(true);});</script>@endsection